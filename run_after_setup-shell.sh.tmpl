#!/usr/bin/env bash

set -euo pipefail

# Setup shell after applying configurations
# This script runs after chezmoi applies all configurations

if command -v gum &>/dev/null; then
  gum style --foreground 213 --bold "âžœ Setting up shell configuration"
else
  echo "Setting up shell configuration..."
fi

# Add ~/.local/bin to PATH if not present
export PATH="${PATH}:${HOME}/.local/bin"

# Set up Fish as default shell if it's installed and not already the default
if command -v fish &>/dev/null && [[ "$SHELL" != *"fish"* ]]; then
    if command -v gum &>/dev/null; then
      gum style --foreground 245 "Fish detected. Make it default with:"
      gum style --foreground 245 "  chsh -s $(which fish)"
    else
      echo "Fish shell detected. To make it your default shell, run:"
      echo "  chsh -s $(which fish)"
    fi
fi

if command -v gum &>/dev/null; then
  gum style --foreground 82 "âœ“ Shell setup complete"
else
  echo "Shell setup complete"
fi

# Display completion message
if command -v gum &>/dev/null; then
  gum style --foreground 213 --bold "ðŸŽ‰ Dotfiles setup complete"
  gum style --foreground 245 "Next: restart terminal â€¢ chezmoi doctor â€¢ chezmoi update"
else
  cat << 'EOF'

ðŸŽ‰ Dotfiles setup complete
Next: restart terminal â€¢ chezmoi doctor â€¢ chezmoi update

EOF
fi
