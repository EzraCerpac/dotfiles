#!/usr/bin/env bash

set -euo pipefail

# Install chezmoi if not already installed
# This script runs once before applying any configurations

{{- if eq .chezmoi.os "darwin" }}
BIN_DIR="${HOME}/.local/bin"
{{- else if eq .chezmoi.os "linux" }}
BIN_DIR="${HOME}/.local/bin"
{{- end }}

mkdir -p "${BIN_DIR}"

if ! command -v chezmoi &>/dev/null; then
    echo "Installing chezmoi..."
    sh -c "$(curl -fsLS get.chezmoi.io)" -- -b "${BIN_DIR}"
    export PATH="${PATH}:${BIN_DIR}"
    echo "chezmoi installed successfully"
else
    echo "chezmoi already installed"
fi